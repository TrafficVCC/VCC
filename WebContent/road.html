<html>

    <head>
        <meta charset="utf-8">
        <title>Counted By Road</title>
        <script src="js/d3.v3.min.js" charset="utf-8"></script>
        <style type="text/css"></style>
        <link rel="stylesheet" type="text/css" href="css/t.css">
        <script src="js/jquery-3.2.1.js" charset="uft-8"></script>
        <script type="text/javascript" src="data.js"></script>
        <script type="text/javascript" src="rosefunc.js" ></script>
        <script type="text/javascript" src="tfunc2.js" ></script>
         <script type="text/javascript" src="rfunc.js" ></script>

    </head>
    
    <body>
      
        <div id="road">
        	<div id="pieDiv" style="float: left;"   class="div-inline" >
        		<svg id="roadpie" width="400" height="400" ></svg>
        	</div>
            <div id="roseDiv" style="float: left;"  class="div-inline" ></div>
        	<div id="lineDiv" width="1000" height="210" class="div-inline" ></div>
         	<div>
            	<svg id="rect2" width="1000" height="300"></svg>
            	<svg id="roadname" width="100" height="300"></svg>
        	</div>
        	
       </div>
       
        
        <script type="text/javascript">
        $.post("/Demo/RoadServlet",
   			 {
   			"type":"lh",   //路号
   			"starty" :"2006",
   			"endy" : "2016",
   			"set" : "0"     //全体
   	    },
               function(data,status){
   	    	data = eval('(' + data + ')');
   	   //画事故数量大于num的lh的饼图
   	    	gragh = "road"+"pie";
		
   	    	var num,num1;
   	    	num = 300;
   	    	num1=0;
   	    	var dataset = [];
   	    	data.forEach(function(d, i){
   	    	    if(d.count >= num)
   	    	        dataset.push([d.lh, d.count]);
   	    	    else
   	    	    	num1+=d.count;
   	    	});
   	    	//小于300的lh归于其他
   	    	//dataset.push(["其他", num1]);  

   	    	//饼状图
   	    	drawPie(dataset, gragh, 400, 400);
      	        });
      	   
        </script>

    </body>
    
</html>
